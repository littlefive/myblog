# 百度云加速 OSS 项目

## 特色功能
1. 可以匹配所有字段的筛选框；

## 使用的库

### BootStrap v3.1.1

* BootStrap 的 CSS 和 Components 可以快速搭建没有严格 UI 图的应用。
* http://getbootstrap.com/
* http://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css

### UI Bootstrap v0.11.0
* 使 BootStrap 的 Components 不需要 jQuery ，可直接在 AngularJS 中使用。
* http://angular-ui.github.io/bootstrap/
* http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.0.min.js

### AngularJS v1.2.10

* 选择这个版本是因为 UI Bootstrap 只完全测试到这个 AngularJS 版本，且官网上有此版本的完整文档。
* https://angularjs.org/
* https://ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular.min.js

### AngularJS Router v1.2.22

* 用于导航菜单点击后无刷新跳转。
* https://angularjs.org/
* https://code.angularjs.org/1.2.22/angular-route.min.js

### AngularJS Animate v.1.2.10

* 筛选列表时产生的动态效果要用到。
* https://angularjs.org/
* http://ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular-animate.min.js

### AngularJS Sanitize v1.2.22

* 配合 ng-bind-html 可直接输出 html 代码，而不经过转义。
* https://angularjs.org/
* http://ajax.googleapis.com/ajax/libs/angularjs/1.2.22/angular-sanitize.min.js

### spin.js

* 用来生成加载中的那个菊花
* http://fgnass.github.io/spin.js/#!
* http://fgnass.github.io/spin.js/spin.min.js

## 目录说明
    -- OSS                根目录
    ----|____ css         OSS 专用样式文件目录
        |____ fonts       bootstrap 库用到的字体文件目录
        |____ images      用到的图片文件目录
        |____ js          OSS 业务相关的 JavaScript 代码目录
               |____ oss.js              OSS App 定义，和用 AngularJS Router 实现无刷新跳转的配置
               |____ controllers.js      OSS 所有的 AngularJS Controller 的实现
               |____ filters.js          OSS 通用的 AngularJS Filter
               |____ services.js         OSS 通用的 AngularJS Service
               |____ static.js           静态配置文件（目前没用）
        |____ lib         OSS 引用的 JavaScript 和 CSS 库目录
        |____ template    OSS 业务相关的 JavaScript 用到的 html 模板目录
        |____ app.html    整个 OSS 系统的入口
        |____ login.html  自定义登录界面，因为申请不到百度 Passport 的 tpl 文件，目前没有使用
        |____ README      本说明文件


## 代码结构说明
### AngularJS Router
OSS 系统使用 AngularJS 的 Router 功能实现无刷新跳转，自动根据 oss.js 的配置替换 app.html 里的
    `<main class="container-fluid" ng-view></main>`
的 innerHTML。
### js/filter.js
处理数据使之适宜前端展示的代码。可以在 AngularJS 的 Expression 中直接 {{ 参数1 | filter名 : 参数2 ：参数3 …… }} 调用，也可以在 AngularJS 的 Controller 中直接 $filter('filter名')(参数1, 参数2, 参数3 ……) 调用。返回处理后的结果。
### js/oss.js
OSS 用到的 AngularJS 组件，和导航菜单跳转的配置。
### css/oss.css
OSS 常用全局样式、覆盖 BootStrap 的样式，以及自定义样式。
### js/services.js
需要跨 Controller 使用的通用方法，比如 HTTP 请求、登录、loading 菊花等。
### js/controllers.js
所有的 Controller 的实现。

containerCtrl 是包含整个 body 最外层的 Controller，配合 $rootScope 定义一些全局变量。

$rootScope 是脏读检查能追溯到的最高层。 $rootScope 里的东西在任何一个 $scope 里都能直接引用（小心不要在 $scope 里创建同名新变量，那就不能通过“$scope.变量名”直接访问了）。为了避免脏读检查，也可以动态注入 $rootScope 变量直接访问之。
### $scope
每个 $scope 都能访问 $rootScope `$scope.$rootScope` 和它的外层 $scope `$scope.$parent`，无法访问平级和子级。

每当创建一个 modal （也就是弹窗），它在传入 $scope 上新建一个子 $scope。所以若在弹窗里的 ng-modal 变量需要被创建它的 controller 访问，得这样 `ng-modal="$parent.变量名"`。

整个 OSS 系统的所有 $scope 之间的关系是这样的包含关系：

    ┌──────────────────────────────────────────────┐
    │  <body> $scope of containerCtrl              │
    │  ┌───────────────────────────────────────┐   │
    │  │  <nav>  $scope of navCtrl             │   │
    │  ├───────────────────────────────────────┤   │
    │  │  <main> $scope of ****Ctrl in depends │   │
    │  │  ┌─────────────────────────────────┐  │   │
    │  │  │  $scope of modal controller     │  │   │
    │  │  └─────────────────────────────────┘  │   │
    │  └───────────────────────────────────────┘   │
    └──────────────────────────────────────────────┘


### 怎么增加导航项

每个导航有五个属性：地址、模板、控制器、名称、父级，共修改以下四个地方：

1.  controllers.js 的 breadCrumbLibrary 对象增加一个属性：
    ``'地址': {
        'parent': 父级,
        self: 名称
    }``

2.  在 controllers.js 里建立一个控制器。

3.  建立一个模板，
    1) 在 template 目录下
    2) 在 app.html 页面里用
    `<script type="text/plain" id="模板id"></script>`
 包裹，推荐前者。

4.  oss.js 的 $routeProvider 配置中增加一项：
    ``.when('地址', {
        templateUrl: '模板相对路径或模板id',
        controller: '控制器名称'
    })``

## 兼容性
适合现代浏览器， IE9+ 访问。BootStrap CSS 自带响应式布局，可适配移动端。

## 部署说明
1.  将整个项目放在和接口同域（域名和端口都相同）的任意静态目录下；
2.  修改 js/services.js 的 `$rootScope.InterfacePath = '/oss/';` 中的 `/oss/` 为实际的接口前缀；
3.  完成，访问 app.html 就行了。

若无法与接口同域，可考虑放在一个带反向代理的静态服务器上，并将路径 `/oss/` 反向代理到接口所在的域名上。

## 后端接口文档
### 云加速 v3.0 API（基于CF架构）
http://wiki.baidu.com/pages/viewpage.action?pageId=35160420
### CloudFare FINAL API Documentation
请联系堂东 litangdong@baidu.com
